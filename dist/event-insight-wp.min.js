/// event-insight-wp v0.1.0-dev 2020-10-01 23:51:19
/// https://github.com/opensums/event-insight-wp-js
/// Copyright Â© 2020 OpenSums (http://opensums.com/)
/// License: MIT
!function(t,e,i){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=s(t),a=s(e),l=s(i);const n=a.default.root+"event-insight/v1",o=a.default.nonce;function d(t){const e=new Date(t).toISOString();return e.substr(0,10)+" "+e.substr(11,8)}function u(t){return r.default.ajax({url:n+t,method:"GET",beforeSend:t=>{t.setRequestHeader("X-WP-Nonce",o)}}).fail((t=>{!function(t){let e;t.responseJSON?e=t.responseJSON.error:t.responseText&&(e=t.responseText),r.default("<div></div>").html(e).dialog({title:`Error ${t.status} ${t.statusText}`,xresizable:!1,modal:!0,xbuttons:{OK:()=>{r.default(this).dialog("close")}}})}(t)})).promise()}r.default("#event-insight-get-ticket-tailor-events").on("click",(()=>{r.default("#event-insight-ticket-tailor-events").html(""),u("/ticket-tailor/events").fail().done((t=>{new l.default("#event-insight-ticket-tailor-events",{layout:"fitDataFill",columns:[{title:"Date",field:"date",sorter:"string",hozAlign:"center"},{title:"Event",field:"event",sorter:"string"},{title:"Id",field:"id",sorter:"string",hozAlign:"center",headerTooltip:"This is what we want to be displayed as the header"},{title:"Published",field:"published",sorter:"boolean",formatter:"tickCross",hozAlign:"center"}],data:t.data.map((t=>({id:t.id,event:t.name,date:t.start.date,published:"published"===t.status}))),rowClick:(t,e)=>{u("/ticket-tailor/event/"+e._row.data.id+"/tickets").fail().done((t=>{const e=[],i={};new l.default("#event-insight-ticket-tailor-tickets",{layout:"fitDataFill",columns:[{title:"Issued",field:"issued",sorter:"string",hozAlign:"center"},{title:"Type",field:"type",sorter:"string"},{title:"Email",field:"email",sorter:"string"},{title:"First name",field:"firstName",sorter:"string"},{title:"Last name",field:"lastName",sorter:"string"},{title:"Id",field:"id",sorter:"string",hozAlign:"center",headerTooltip:"This is what we want to be displayed as the header"},{title:"Valid",field:"isValid",sorter:"boolean",formatter:"tickCross",hozAlign:"center"},{title:"Q1",field:"qa1",sorter:"string"},{title:"Q2",field:"qa2",sorter:"string"},{title:"Q3",field:"qa3",sorter:"string"},{title:"Q4",field:"qa4",sorter:"string"},{title:"Q5",field:"qa5",sorter:"string"}],data:t.data.map((t=>{const s={id:t.id,type:t.description,email:t.email,firstName:t.first_name,lastName:t.last_name,issued:d(1e3*t.created_at),isValid:"valid"===t.status};return t.custom_questions.forEach((({question:t,answer:r})=>{void 0===i[t]&&(i[t]=e.length,e.push(t)),s["qa"+i[t]]=r})),s}))})}))}})}))}))}(jQuery,wpApiSettings,Tabulator);
